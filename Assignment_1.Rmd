---
title: "Assignment 1"
author: "Angela Zhai"
date: "September 14, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(knitr.kable.NA = '')
pacman::p_load("knitr","kableExtra","jpeg","png")
```

## Document assignment

Consider the following situation:  
  
A sloppy printer produces books with an average of 2 misprints per page. You want to
know how many pages have more than k misprints in a book of n pages. Make an n x k table that shows the relationship between the total number of pages in a book and the number of pages with k misprints.

Show and explain your work.  Include equations and calculations to teach the reader how to solve the problem.  Include an image of a book.

Push your solution to a github repository and submit the url for repository on blackboard.
Be sure your repo includes your document as a pdf file and as an RMD file.  Include other files needed to recompile your document.

## Result

```{r echo=FALSE}
library(knitr)
library(kableExtra)

nrow = 6
ncol = 6

k <- c(2,3,4,5,6,7)
n <- c(100,200,300,400,500,600)

error <- data.frame()
error[3,1] <- "Total"
error[4,1] <- "Pages"

for (m in 1:nrow){
  error[m,2] <- n[m]
}

set.seed(2018)
misprints <- rpois(n = 10000,lambda = 2)

for (sel in 1:nrow){
  for (selc in 1:ncol){
    error[sel,selc+2] <- length(which(misprints[]>=k[sel]))/length(misprints)
  }
}

colnames(error) <- c(" ", " ", "2", "3", "4", "5", "6", "7")

kable(x = error, booktabs = T, caption = "Probability of pages with k misprints") %>%
  kable_styling(position = "center", latex_options = "hold_position") %>%
  add_header_above(c(" " = 2, "Least Misprints" = 6))
```

For this question, I think the probability of "more than k misprints" is invariant for a specified k. But if we would like to find out the probability of total misprints within n pages book, the situation follows poisson distribution.

The table above is generated by simulation. A vector contains 10000 random elements which follow poisson distribution, and lamda equal 2. The proportion of numbers greater than k in 10000 elements is nearly identical to the theoritical probability.

##Another table
```{r echo=FALSE}
nrow = 8
ncol = 6

k <- c(100,200,300,400,500,600,700,800)
n <- c(100,200,300,400,500,600)

error <- data.frame()
error[4,1] <- "Least"
error[5,1] <- "Errors"

for (m in 1:nrow){
  error[m,2] <- k[m]
}

for(i in 1:nrow){
  for (j in 1:ncol){
    freq <- k[i]/n[j]
    error[i,j+2] <- ppois(q = freq, lambda = 2, lower.tail = FALSE)
  }
}

colnames(error) <- c(" ", " ", "100", "200", "300", "400", "500", "600")

kable(x = error, booktabs = T, caption = "Probability of total misprints within n pages") %>%
  kable_styling(position = "center", latex_options = "hold_position") %>%
  add_header_above(c(" " = 2, "pages" = 6))
```

I also consider the situation of least errors appear within n pages, so the cumulative probability of poisson distribution is needed.

The equation to get CDF of poisson distribution is:
$e^{-\lambda }\sum_{i=0}^{k}\frac{\lambda ^{i}}{i!}$
  
Like if we get more than 100 misprints in a book of 100 pages, the equation should look like:
$e^{-2}\sum_{i=100}^{n}\frac{2^{i}}{i!}$

The main part of the code is:
#ppois(q=freq, lamda=2, lower.tail=FALSE).
Function ppois is used to calculate CDF for poisson distribution; q assigns the average errors for one page in a book of n pages; lamda assigns average misprints per page of this printer; lower.tail=FALSE means we try to get the cumulated value for errors more than q.

#Image

```{r out.width = "50%", fig.align = "center", echo=FALSE}
knitr::include_graphics("book-pile.jpg")
```

